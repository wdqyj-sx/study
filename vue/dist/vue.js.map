{"version":3,"file":"vue.js","sources":["../src/array.js","../src/utils.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["let oldArrayPrototype = Array.prototype;\r\nexport let arrayMethods = Object.create(oldArrayPrototype);\r\nlet methods = [\r\n    'push',\r\n    'shift',\r\n    'unshift',\r\n    'pop',\r\n    'reverse',\r\n    'sort',\r\n    'splice'\r\n]\r\n\r\nmethods.forEach(method =>{\r\n    arrayMethods[method] = function(...args){\r\n        console.log('数组改变了');\r\n        // oldArrayPrototype[method].call(this,...args);\r\n    }\r\n})","export function isFunction(val) { \r\n    return typeof val === 'function';\r\n}\r\n\r\nexport function isObject(val) {\r\n   return typeof val === 'object'&& val!==null;\r\n}","import { arrayMethods } from \"../array\";\r\nimport { isObject } from \"../utils\";\r\n\r\n// 创建观测者\r\nclass Observer{\r\n    constructor(data){\r\n        if(Array.isArray(data)){\r\n            data.__propo__ = arrayMethods;\r\n            // console.log(data)\r\n        }\r\n        else {\r\n        //对对象中的所有属性进行劫持\r\n        this.walk(data);\r\n        }\r\n    }\r\n    walk(data){\r\n        Object.keys(data).forEach(key =>{\r\n          defineReactive(data,key,data[key]);\r\n        })\r\n    }\r\n}\r\nfunction defineReactive(data,key,value){\r\n    observe(value)\r\n    Object.defineProperty(data,key,{\r\n        get(){\r\n            return value;\r\n        },\r\n        set(newV) {\r\n            // observe(value)\r\n            value = newV;\r\n        }\r\n    })\r\n}\r\n\r\nexport function observe(data) {\r\n    // 判断数据是否为对象\r\n    if(!isObject(data)){\r\n        return ;\r\n    }\r\n    //创建观测者来观测数据\r\n    return new Observer(data);\r\n}","\r\nimport { observe } from \"./observer/index\";\r\nimport { isFunction } from \"./utils\";\r\n\r\nexport function initState(vm){\r\n    const opts = vm.$options;\r\n    if(opts.data){\r\n        // 数据存在，则劫持数据\r\n        initData(vm);\r\n        \r\n    }\r\n}\r\n\r\nfunction proxy(vm,source,key){\r\n    Object.defineProperty(vm,key,{\r\n        get(){\r\n            return vm[source][key];\r\n        },\r\n        set(newV){\r\n            vm[source][key] = newV;\r\n        }\r\n    })\r\n}\r\nfunction initData(vm){\r\n    let data = vm.$options.data;\r\n    // 判断data是函数还是对象,获取其对象数据\r\n    data = vm._data =  isFunction(data)?data(vm):data;\r\n    // 将数据挂载到vm上\r\n    for(let key in data){\r\n        proxy(vm,'_data',key);\r\n    }\r\n    //观察数据\r\n    observe(data);\r\n}","import { initState } from \"./state\";\r\n\r\nexport function initMixin(Vue){\r\n    // 在Vue类的原型上添加这个函数\r\n    Vue.prototype._init = function(options){\r\n        const vm = this;\r\n        // 在原型上添加一个属性保存数据\r\n        vm.$options = options;//\r\n        //开始对数据进行劫持\r\n        initState(vm);\r\n    }\r\n}","import { initMixin } from \"./init\";\r\n\r\nfunction Vue(options) {\r\n    //options 为传入的选项\r\n    this._init(options)\r\n}\r\ninitMixin(Vue);\r\n\r\nexport default Vue;"],"names":["oldArrayPrototype","Array","prototype","arrayMethods","Object","create","methods","forEach","method","console","log","isFunction","val","isObject","Observer","data","isArray","__propo__","walk","keys","key","defineReactive","value","observe","defineProperty","get","set","newV","initState","vm","opts","$options","initData","proxy","source","_data","initMixin","Vue","_init","options"],"mappings":"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"}