{"version":3,"file":"vue.js","sources":["../src/compiler/generate.js","../src/compiler/parse.js","../src/compiler/index.js","../src/observer/array.js","../src/utils.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; \r\n\r\nfunction gen(el){\r\n    if(el.type === 1){\r\n        return generate(el)\r\n    }\r\n    else {\r\n        let text = el.text;\r\n        if(!defaultTagRE.test(text)){\r\n            return `_v(${text})`\r\n        }else {\r\n            let tokens = [];\r\n            let match;\r\n            let lastIndex = defaultTagRE.lastIndex = 0;\r\n            while(match = defaultTagRE.exec(text)){\r\n                let index = match.index;\r\n                if(index > lastIndex){\r\n                    tokens.push(JSON.stringify(text.slice(lastIndex,index)))\r\n                }\r\n                tokens.push(`_s(${match[1].trim()})`);\r\n                lastIndex = lastIndex+match[0].length;\r\n            }\r\n            if(lastIndex < text.length){\r\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n            }\r\n            return `_v(${tokens.join('+')})`\r\n        }\r\n    }\r\n}\r\nfunction genChildren(el){\r\n    let children = el.children;\r\n    if(children) {\r\n        return children.map(c => gen(c).join(','))\r\n    }\r\n    return false;\r\n}\r\nfunction genProps(attrs){\r\n    let str = \"\";\r\n    for(let i = 0;i<attrs;++i){\r\n        let attr = attrs[i];\r\n        if(attr.name === \"style\"){\r\n            let styleObj = {}\r\n            attr.value.replace(/([^:;])\\:([^:;])/g,function(){\r\n                styleObj[arguments[1]] = arguments[2];\r\n            })\r\n            attr.value = styleObj;\r\n        }\r\n        str += `${attr.name}:${JSON.stringify(attr.value)},`\r\n    }\r\n    return `{${str.slice(0,-1)}}`\r\n}\r\nexport function generate(el){\r\n    let children = genChildren(el);\r\n    let code = `_c('${el.tag}',${\r\n        el.attrs.length? genProps(el.attrs):'undefine'\r\n    }${\r\n        children?`,${children}`:''\r\n    })`\r\n    return code;\r\n}","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;//匹配标签名\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;//捕获标签名\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`);//匹配开始标签\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`) //匹配闭合标签\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'<>=`]+)))?/;//匹配属性\r\n\r\nconst startTagClose = /^\\s*(\\/?)>/; //匹配开始标签中的闭合标志\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g;//匹配属性\r\n\r\n//创建一个ast树结构\r\nfunction createAstElement(tagName,attrs){\r\n    return {\r\n        tag:tagName,\r\n        type:1,\r\n        children:[],\r\n        parent:null,\r\n        attrs\r\n    }\r\n}\r\n\r\nlet root = null;\r\nlet stack = [];\r\n//开始标签处理方法\r\nfunction start(tagName,attrs) {\r\n    //创建父子节点关系\r\n    //拿到父节点\r\n    let parent = stack[stack.length - 1];\r\n    let element = createAstElement(tagName,attrs);\r\n    if(!root) {\r\n        root = element;\r\n    }\r\n    if(parent) {\r\n        element.parent = parent;\r\n        parent.children.push(element);\r\n    }\r\n    stack.push(element);//进栈\r\n}\r\n//闭合标签处理方法\r\nfunction end(tagName) {\r\n    let last = stack.pop();\r\n    if(last.tag !== tagName){\r\n        throw new Error('标签有误');\r\n    }\r\n}\r\n//文本处理方法\r\nfunction chars(text) {\r\n    text = text.replace(/\\s/g,\"\");\r\n    let parent = stack[stack.length - 1];\r\n    if(text){\r\n        parent.children.push({\r\n            type:3,\r\n            text\r\n        })\r\n    }\r\n}\r\n// parseHTML('<div age=\"18\">{{name}}</div>')\r\n// 按词法解析html\r\nexport function parseHTML(html){\r\n  \r\n    //删除已经处理了的文本\r\n    function advance(len){\r\n        html = html.substring(len);\r\n    }\r\n    //解析开始标签\r\n    function parseStartTag() {\r\n        // 匹配开始标签\r\n        const start = html.match(startTagOpen);\r\n        if(start) {\r\n            //初始化标签名和属性\r\n            const match = {\r\n                tagName:start[1],\r\n                attrs:[]\r\n            }\r\n            advance(start[0].length);\r\n            let end;\r\n            let attr;\r\n            // 匹配属性\r\n            while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))){\r\n                //匹配到属性\r\n                match.attrs.push({\r\n                    name:attr[1],\r\n                    value:attr[3]||attr[4]||attr[5]\r\n                })\r\n                advance(attr[0].length);\r\n              \r\n            }\r\n            //匹配到开始标签中的闭合结尾\r\n            if(end){\r\n                advance(end[0].length);\r\n            }\r\n            return match;\r\n\r\n        }\r\n       return false;\r\n    }\r\n    //循环解析\r\n    while(html){\r\n       \r\n        let textEnd = html.indexOf('<'); //获取当前解析的开头\r\n        if(textEnd === 0){\r\n            // 说明这是开始的标签\r\n            const startTagMatch = parseStartTag(html);\r\n            // 匹配到了开始标签和属性,开始处理开始标签\r\n            if(startTagMatch){\r\n                start(startTagMatch.tagName,startTagMatch.attrs);\r\n                continue;\r\n            }\r\n            // 也有可能是闭合标签\r\n          const endTagMatch = html.match(endTag);\r\n          if(endTagMatch){\r\n              end(endTagMatch[1]);\r\n              advance(endTagMatch[0].length);\r\n              continue;\r\n          }\r\n\r\n        }\r\n        // 如果不等于0,说明是文本内容\r\n        let text;\r\n        if(textEnd > 0) {\r\n             text = html.substring(0,textEnd);\r\n        }\r\n        if(text) {\r\n            chars(text);\r\n            advance(text.length);\r\n        }\r\n      \r\n\r\n    }\r\n    return root;\r\n}","import { generate } from \"./generate\";\r\nimport { parseHTML } from \"./parse\";\r\n\r\nexport function compileToFunction(template){\r\n    //按词法解析html\r\n \r\n   let root = parseHTML(template);\r\n    // 将ast树生成代码\r\n    let code = generate(root);\r\n \r\n   \r\n}","let oldArrayPrototype = Array.prototype;\r\nexport let arrayMethods = Object.create(oldArrayPrototype);\r\nlet methods = [\r\n    'push',\r\n    'shift',\r\n    'unshift',\r\n    'pop',\r\n    'reverse',\r\n    'sort',\r\n    'splice'\r\n]\r\n\r\nmethods.forEach(method =>{\r\n    arrayMethods[method] = function(...args){\r\n        console.log('数组改变了');\r\n        oldArrayPrototype[method].call(this,...args);\r\n        // 通过push、unshift、splice方法也可能对数据进行更改\r\n        let po = this.__po__;\r\n        let inserted;\r\n        switch (method) {\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = args;\r\n                break;\r\n            case 'splice':\r\n                inserted = args.slice(2);\r\n                break;\r\n        }\r\n        if(inserted) {\r\n            po.observeArray(inserted);\r\n        }\r\n    }\r\n})","export function isFunction(val) { \r\n    return typeof val === 'function';\r\n}\r\n\r\nexport function isObject(val) {\r\n   return typeof val === 'object'&& val!==null;\r\n}","import {arrayMethods} from \"./array\";\r\nimport { isObject } from \"../utils\";\r\n\r\n// 创建观测者\r\nclass Observer{\r\n    constructor(data){\r\n        // data.__po__ = this;\r\n        Object.defineProperty(data,'__po__',{\r\n            value:this,\r\n            enumerable:false\r\n        })\r\n        if(Array.isArray(data)){\r\n            data.__proto__ = arrayMethods;\r\n            this.observeArray(data);\r\n        }\r\n        else {\r\n        //对对象中的所有属性进行劫持\r\n        this.walk(data);\r\n        }\r\n    }\r\n    // 如果数组中包含对象，则再次被监控\r\n    observeArray(data){\r\n        data.forEach(item =>{\r\n            observe(data);\r\n        })\r\n    }\r\n    walk(data){\r\n        Object.keys(data).forEach(key =>{\r\n          defineReactive(data,key,data[key]);\r\n        })\r\n    }\r\n}\r\nfunction defineReactive(data,key,value){\r\n    observe(value)\r\n    Object.defineProperty(data,key,{\r\n        get(){\r\n            return value;\r\n        },\r\n        set(newV) {\r\n             observe(value)\r\n            value = newV;\r\n        }\r\n    })\r\n}\r\n\r\nexport function observe(data) {\r\n    // 判断数据是否为对象\r\n    if(!isObject(data)){\r\n        return ;\r\n    }\r\n    if(data.__po__){\r\n        return ;\r\n    }\r\n    //创建观测者来观测数据\r\n    return new Observer(data);\r\n}","\r\nimport { observe } from \"./observer/index\";\r\nimport { isFunction } from \"./utils\";\r\n\r\nexport function initState(vm){\r\n    const opts = vm.$options;\r\n    if(opts.data){\r\n        // 数据存在，则劫持数据\r\n        initData(vm);\r\n        \r\n    }\r\n}\r\n\r\nfunction proxy(vm,source,key){\r\n    Object.defineProperty(vm,key,{\r\n        get(){\r\n            return vm[source][key];\r\n        },\r\n        set(newV){\r\n            vm[source][key] = newV;\r\n        }\r\n    })\r\n}\r\nfunction initData(vm){\r\n    let data = vm.$options.data;\r\n    // 判断data是函数还是对象,获取其对象数据\r\n    data = vm._data =  isFunction(data)?data(vm):data;\r\n    // 将数据挂载到vm上\r\n    for(let key in data){\r\n        proxy(vm,'_data',key);\r\n    }\r\n    //观察数据\r\n    observe(data);\r\n}","import { compileToFunction } from \"./compiler/index\";\r\nimport { initState } from \"./state\";\r\n\r\nexport function initMixin(Vue){\r\n    // 在Vue类的原型上添加这个函数\r\n    Vue.prototype._init = function(options){\r\n        const vm = this;\r\n        // 在原型上添加一个属性保存数据\r\n        vm.$options = options;//\r\n        //开始对数据进行劫持\r\n        initState(vm);\r\n    }\r\n    Vue.prototype.$mount = function(el) {\r\n        const vm = this;\r\n        const options = vm.$options;\r\n        //拿到节点;\r\n        el = document.querySelector(el);\r\n        // 将节点挂载到vm上\r\n        vm.$el = el;\r\n        //判断option有没有调用render和template，否则则对dom节点进行词法分析，生成ast树\r\n        if(!options.render){\r\n            let template = options.template;\r\n            if(!template && el){\r\n                //获取渲染节点内容\r\n                template = el.outerHTML;\r\n                //进行词法分析，生成ast树\r\n                let render = compileToFunction(template);\r\n                //将render方法挂载到options上\r\n                options.render = render;\r\n            }\r\n        }\r\n    }\r\n}","import { initMixin } from \"./init\";\r\n\r\nfunction Vue(options) {\r\n    //options 为传入的选项\r\n    this._init(options)\r\n}\r\ninitMixin(Vue);\r\n\r\nexport default Vue;"],"names":["defaultTagRE","gen","el","type","generate","text","test","tokens","match","lastIndex","exec","index","push","JSON","stringify","slice","trim","length","join","genChildren","children","map","c","genProps","attrs","str","i","attr","name","styleObj","value","replace","arguments","code","tag","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","createAstElement","tagName","parent","root","stack","start","element","end","last","pop","Error","chars","parseHTML","html","advance","len","substring","parseStartTag","textEnd","indexOf","startTagMatch","endTagMatch","compileToFunction","template","oldArrayPrototype","Array","prototype","arrayMethods","Object","create","methods","forEach","method","console","log","args","call","po","__po__","inserted","observeArray","isFunction","val","isObject","Observer","data","defineProperty","enumerable","isArray","__proto__","walk","item","observe","keys","key","defineReactive","get","set","newV","initState","vm","opts","$options","initData","proxy","source","_data","initMixin","Vue","_init","options","$mount","document","querySelector","$el","render","outerHTML"],"mappings":";;;;;;IAAA,IAAMA,YAAY,GAAG,0BAArB;;IAEA,SAASC,GAAT,CAAaC,EAAb,EAAgB;IACZ,MAAGA,EAAE,CAACC,IAAH,KAAY,CAAf,EAAiB;IACb,WAAOC,QAAQ,CAACF,EAAD,CAAf;IACH,GAFD,MAGK;IACD,QAAIG,IAAI,GAAGH,EAAE,CAACG,IAAd;;IACA,QAAG,CAACL,YAAY,CAACM,IAAb,CAAkBD,IAAlB,CAAJ,EAA4B;IACxB,0BAAaA,IAAb;IACH,KAFD,MAEM;IACF,UAAIE,MAAM,GAAG,EAAb;IACA,UAAIC,KAAJ;IACA,UAAIC,SAAS,GAAGT,YAAY,CAACS,SAAb,GAAyB,CAAzC;;IACA,aAAMD,KAAK,GAAGR,YAAY,CAACU,IAAb,CAAkBL,IAAlB,CAAd,EAAsC;IAClC,YAAIM,KAAK,GAAGH,KAAK,CAACG,KAAlB;;IACA,YAAGA,KAAK,GAAGF,SAAX,EAAqB;IACjBF,UAAAA,MAAM,CAACK,IAAP,CAAYC,IAAI,CAACC,SAAL,CAAeT,IAAI,CAACU,KAAL,CAAWN,SAAX,EAAqBE,KAArB,CAAf,CAAZ;IACH;;IACDJ,QAAAA,MAAM,CAACK,IAAP,cAAkBJ,KAAK,CAAC,CAAD,CAAL,CAASQ,IAAT,EAAlB;IACAP,QAAAA,SAAS,GAAGA,SAAS,GAACD,KAAK,CAAC,CAAD,CAAL,CAASS,MAA/B;IACH;;IACD,UAAGR,SAAS,GAAGJ,IAAI,CAACY,MAApB,EAA2B;IACvBV,QAAAA,MAAM,CAACK,IAAP,CAAYC,IAAI,CAACC,SAAL,CAAeT,IAAI,CAACU,KAAL,CAAWN,SAAX,CAAf,CAAZ;IACH;;IACD,0BAAaF,MAAM,CAACW,IAAP,CAAY,GAAZ,CAAb;IACH;IACJ;IACJ;;IACD,SAASC,WAAT,CAAqBjB,EAArB,EAAwB;IACpB,MAAIkB,QAAQ,GAAGlB,EAAE,CAACkB,QAAlB;;IACA,MAAGA,QAAH,EAAa;IACT,WAAOA,QAAQ,CAACC,GAAT,CAAa,UAAAC,CAAC;IAAA,aAAIrB,GAAG,CAACqB,CAAD,CAAH,CAAOJ,IAAP,CAAY,GAAZ,CAAJ;IAAA,KAAd,CAAP;IACH;;IACD,SAAO,KAAP;IACH;;IACD,SAASK,QAAT,CAAkBC,KAAlB,EAAwB;IACpB,MAAIC,GAAG,GAAG,EAAV;;IACA,OAAI,IAAIC,CAAC,GAAG,CAAZ,EAAcA,CAAC,GAACF,KAAhB,EAAsB,EAAEE,CAAxB,EAA0B;IACtB,QAAIC,IAAI,GAAGH,KAAK,CAACE,CAAD,CAAhB;;IACA,QAAGC,IAAI,CAACC,IAAL,KAAc,OAAjB,EAAyB;IAAA;IACrB,YAAIC,QAAQ,GAAG,EAAf;IACAF,QAAAA,IAAI,CAACG,KAAL,CAAWC,OAAX,CAAmB,mBAAnB,EAAuC,YAAU;IAC7CF,UAAAA,QAAQ,CAACG,SAAS,CAAC,CAAD,CAAV,CAAR,GAAyBA,SAAS,CAAC,CAAD,CAAlC;IACH,SAFD;IAGAL,QAAAA,IAAI,CAACG,KAAL,GAAaD,QAAb;IALqB;IAMxB;;IACDJ,IAAAA,GAAG,cAAOE,IAAI,CAACC,IAAZ,cAAoBf,IAAI,CAACC,SAAL,CAAea,IAAI,CAACG,KAApB,CAApB,MAAH;IACH;;IACD,oBAAWL,GAAG,CAACV,KAAJ,CAAU,CAAV,EAAY,CAAC,CAAb,CAAX;IACH;;IACM,SAASX,QAAT,CAAkBF,EAAlB,EAAqB;IACxB,MAAIkB,QAAQ,GAAGD,WAAW,CAACjB,EAAD,CAA1B;IACA,MAAI+B,IAAI,iBAAU/B,EAAE,CAACgC,GAAb,eACJhC,EAAE,CAACsB,KAAH,CAASP,MAAT,GAAiBM,QAAQ,CAACrB,EAAE,CAACsB,KAAJ,CAAzB,GAAoC,UADhC,SAGJJ,QAAQ,cAAKA,QAAL,IAAgB,EAHpB,MAAR;IAKA,SAAOa,IAAP;IACH;;IC3DD,IAAME,MAAM,iCAAZ;;IACA,IAAMC,YAAY,iBAAUD,MAAV,kBAAwBA,MAAxB,MAAlB;;IACA,IAAME,YAAY,GAAG,IAAIC,MAAJ,aAAgBF,YAAhB,EAArB;;IACA,IAAMG,MAAM,GAAG,IAAID,MAAJ,gBAAmBF,YAAnB,YAAf;;IACA,IAAMI,SAAS,GAAG,2EAAlB;;IAEA,IAAMC,aAAa,GAAG,YAAtB;IAGA;;IACA,SAASC,gBAAT,CAA0BC,OAA1B,EAAkCnB,KAAlC,EAAwC;IACpC,SAAO;IACHU,IAAAA,GAAG,EAACS,OADD;IAEHxC,IAAAA,IAAI,EAAC,CAFF;IAGHiB,IAAAA,QAAQ,EAAC,EAHN;IAIHwB,IAAAA,MAAM,EAAC,IAJJ;IAKHpB,IAAAA,KAAK,EAALA;IALG,GAAP;IAOH;;IAED,IAAIqB,IAAI,GAAG,IAAX;IACA,IAAIC,KAAK,GAAG,EAAZ;;IAEA,SAASC,KAAT,CAAeJ,OAAf,EAAuBnB,KAAvB,EAA8B;IAC1B;IACA;IACA,MAAIoB,MAAM,GAAGE,KAAK,CAACA,KAAK,CAAC7B,MAAN,GAAe,CAAhB,CAAlB;IACA,MAAI+B,OAAO,GAAGN,gBAAgB,CAACC,OAAD,EAASnB,KAAT,CAA9B;;IACA,MAAG,CAACqB,IAAJ,EAAU;IACNA,IAAAA,IAAI,GAAGG,OAAP;IACH;;IACD,MAAGJ,MAAH,EAAW;IACPI,IAAAA,OAAO,CAACJ,MAAR,GAAiBA,MAAjB;IACAA,IAAAA,MAAM,CAACxB,QAAP,CAAgBR,IAAhB,CAAqBoC,OAArB;IACH;;IACDF,EAAAA,KAAK,CAAClC,IAAN,CAAWoC,OAAX,EAZ0B;IAa7B;;;IAED,SAASC,GAAT,CAAaN,OAAb,EAAsB;IAClB,MAAIO,IAAI,GAAGJ,KAAK,CAACK,GAAN,EAAX;;IACA,MAAGD,IAAI,CAAChB,GAAL,KAAaS,OAAhB,EAAwB;IACpB,UAAM,IAAIS,KAAJ,CAAU,MAAV,CAAN;IACH;IACJ;;;IAED,SAASC,KAAT,CAAehD,IAAf,EAAqB;IACjBA,EAAAA,IAAI,GAAGA,IAAI,CAAC0B,OAAL,CAAa,KAAb,EAAmB,EAAnB,CAAP;IACA,MAAIa,MAAM,GAAGE,KAAK,CAACA,KAAK,CAAC7B,MAAN,GAAe,CAAhB,CAAlB;;IACA,MAAGZ,IAAH,EAAQ;IACJuC,IAAAA,MAAM,CAACxB,QAAP,CAAgBR,IAAhB,CAAqB;IACjBT,MAAAA,IAAI,EAAC,CADY;IAEjBE,MAAAA,IAAI,EAAJA;IAFiB,KAArB;IAIH;IACJ;IAED;;;IACO,SAASiD,SAAT,CAAmBC,IAAnB,EAAwB;IAE3B;IACA,WAASC,OAAT,CAAiBC,GAAjB,EAAqB;IACjBF,IAAAA,IAAI,GAAGA,IAAI,CAACG,SAAL,CAAeD,GAAf,CAAP;IACH,GAL0B;;;IAO3B,WAASE,aAAT,GAAyB;IACrB;IACA,QAAMZ,KAAK,GAAGQ,IAAI,CAAC/C,KAAL,CAAW6B,YAAX,CAAd;;IACA,QAAGU,KAAH,EAAU;IACN;IACA,UAAMvC,KAAK,GAAG;IACVmC,QAAAA,OAAO,EAACI,KAAK,CAAC,CAAD,CADH;IAEVvB,QAAAA,KAAK,EAAC;IAFI,OAAd;IAIAgC,MAAAA,OAAO,CAACT,KAAK,CAAC,CAAD,CAAL,CAAS9B,MAAV,CAAP;;IACA,UAAIgC,IAAJ;;IACA,UAAItB,IAAJ,CARM;;IAUN,aAAM,EAAEsB,IAAG,GAAGM,IAAI,CAAC/C,KAAL,CAAWiC,aAAX,CAAR,MAAuCd,IAAI,GAAG4B,IAAI,CAAC/C,KAAL,CAAWgC,SAAX,CAA9C,CAAN,EAA2E;IACvE;IACAhC,QAAAA,KAAK,CAACgB,KAAN,CAAYZ,IAAZ,CAAiB;IACbgB,UAAAA,IAAI,EAACD,IAAI,CAAC,CAAD,CADI;IAEbG,UAAAA,KAAK,EAACH,IAAI,CAAC,CAAD,CAAJ,IAASA,IAAI,CAAC,CAAD,CAAb,IAAkBA,IAAI,CAAC,CAAD;IAFf,SAAjB;IAIA6B,QAAAA,OAAO,CAAC7B,IAAI,CAAC,CAAD,CAAJ,CAAQV,MAAT,CAAP;IAEH,OAlBK;;;IAoBN,UAAGgC,IAAH,EAAO;IACHO,QAAAA,OAAO,CAACP,IAAG,CAAC,CAAD,CAAH,CAAOhC,MAAR,CAAP;IACH;;IACD,aAAOT,KAAP;IAEH;;IACF,WAAO,KAAP;IACF,GArC0B;;;IAuC3B,SAAM+C,IAAN,EAAW;IAEP,QAAIK,OAAO,GAAGL,IAAI,CAACM,OAAL,CAAa,GAAb,CAAd,CAFO;;IAGP,QAAGD,OAAO,KAAK,CAAf,EAAiB;IACb;IACA,UAAME,aAAa,GAAGH,aAAa,CAAA,CAAnC,CAFa;;IAIb,UAAGG,aAAH,EAAiB;IACbf,QAAAA,KAAK,CAACe,aAAa,CAACnB,OAAf,EAAuBmB,aAAa,CAACtC,KAArC,CAAL;IACA;IACH,OAPY;;;IASf,UAAMuC,WAAW,GAAGR,IAAI,CAAC/C,KAAL,CAAW+B,MAAX,CAApB;;IACA,UAAGwB,WAAH,EAAe;IACXd,QAAAA,GAAG,CAACc,WAAW,CAAC,CAAD,CAAZ,CAAH;IACAP,QAAAA,OAAO,CAACO,WAAW,CAAC,CAAD,CAAX,CAAe9C,MAAhB,CAAP;IACA;IACH;IAEF,KAnBM;;;IAqBP,QAAIZ,IAAI,SAAR;;IACA,QAAGuD,OAAO,GAAG,CAAb,EAAgB;IACXvD,MAAAA,IAAI,GAAGkD,IAAI,CAACG,SAAL,CAAe,CAAf,EAAiBE,OAAjB,CAAP;IACJ;;IACD,QAAGvD,IAAH,EAAS;IACLgD,MAAAA,KAAK,CAAChD,IAAD,CAAL;IACAmD,MAAAA,OAAO,CAACnD,IAAI,CAACY,MAAN,CAAP;IACH;IAGJ;;IACD,SAAO4B,IAAP;IACH;;IC9HM,SAASmB,iBAAT,CAA2BC,QAA3B,EAAoC;IACvC;IAED,MAAIpB,IAAI,GAAGS,SAAS,CAACW,QAAD,CAApB,CAHwC;;IAKvC,EAAW7D,QAAQ,CAACyC,IAAD;IAGtB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICXD,IAAIqB,iBAAiB,GAAGC,KAAK,CAACC,SAA9B;IACO,IAAIC,YAAY,GAAGC,MAAM,CAACC,MAAP,CAAcL,iBAAd,CAAnB;IACP,IAAIM,OAAO,GAAG,CACV,MADU,EAEV,OAFU,EAGV,SAHU,EAIV,KAJU,EAKV,SALU,EAMV,MANU,EAOV,QAPU,CAAd;IAUAA,OAAO,CAACC,OAAR,CAAgB,UAAAC,MAAM,EAAG;IACrBL,EAAAA,YAAY,CAACK,MAAD,CAAZ,GAAuB,YAAiB;IAAA;;IACpCC,IAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ;;IADoC,sCAALC,IAAK;IAALA,MAAAA,IAAK;IAAA;;IAEpC,6BAAAX,iBAAiB,CAACQ,MAAD,CAAjB,EAA0BI,IAA1B,+BAA+B,IAA/B,SAAuCD,IAAvC,GAFoC;;;IAIpC,QAAIE,EAAE,GAAG,KAAKC,MAAd;IACA,QAAIC,QAAJ;;IACA,YAAQP,MAAR;IACI,WAAK,MAAL;IACA,WAAK,SAAL;IACIO,QAAAA,QAAQ,GAAGJ,IAAX;IACA;;IACJ,WAAK,QAAL;IACII,QAAAA,QAAQ,GAAGJ,IAAI,CAAC9D,KAAL,CAAW,CAAX,CAAX;IACA;IAPR;;IASA,QAAGkE,QAAH,EAAa;IACTF,MAAAA,EAAE,CAACG,YAAH,CAAgBD,QAAhB;IACH;IACJ,GAlBD;IAmBH,CApBD;;ICZO,SAASE,UAAT,CAAoBC,GAApB,EAAyB;IAC5B,SAAO,OAAOA,GAAP,KAAe,UAAtB;IACH;IAEM,SAASC,QAAT,CAAkBD,GAAlB,EAAuB;IAC3B,SAAO,QAAOA,GAAP,MAAe,QAAf,IAA0BA,GAAG,KAAG,IAAvC;IACF;;QCFKE;IACF,oBAAYC,IAAZ,EAAiB;IAAA;;IACb;IACAjB,IAAAA,MAAM,CAACkB,cAAP,CAAsBD,IAAtB,EAA2B,QAA3B,EAAoC;IAChCzD,MAAAA,KAAK,EAAC,IAD0B;IAEhC2D,MAAAA,UAAU,EAAC;IAFqB,KAApC;;IAIA,QAAGtB,KAAK,CAACuB,OAAN,CAAcH,IAAd,CAAH,EAAuB;IACnBA,MAAAA,IAAI,CAACI,SAAL,GAAiBtB,YAAjB;IACA,WAAKa,YAAL,CAAkBK,IAAlB;IACH,KAHD,MAIK;IACL;IACA,WAAKK,IAAL,CAAUL,IAAV;IACC;IACJ;;;;;eAED,sBAAaA,IAAb,EAAkB;IACdA,MAAAA,IAAI,CAACd,OAAL,CAAa,UAAAoB,IAAI,EAAG;IAChBC,QAAAA,OAAO,CAACP,IAAD,CAAP;IACH,OAFD;IAGH;;;eACD,cAAKA,IAAL,EAAU;IACNjB,MAAAA,MAAM,CAACyB,IAAP,CAAYR,IAAZ,EAAkBd,OAAlB,CAA0B,UAAAuB,GAAG,EAAG;IAC9BC,QAAAA,cAAc,CAACV,IAAD,EAAMS,GAAN,EAAUT,IAAI,CAACS,GAAD,CAAd,CAAd;IACD,OAFD;IAGH;;;;;;IAEL,SAASC,cAAT,CAAwBV,IAAxB,EAA6BS,GAA7B,EAAiClE,KAAjC,EAAuC;IACnCgE,EAAAA,OAAO,CAAChE,KAAD,CAAP;IACAwC,EAAAA,MAAM,CAACkB,cAAP,CAAsBD,IAAtB,EAA2BS,GAA3B,EAA+B;IAC3BE,IAAAA,GAD2B,iBACtB;IACD,aAAOpE,KAAP;IACH,KAH0B;IAI3BqE,IAAAA,GAJ2B,eAIvBC,IAJuB,EAIjB;IACLN,MAAAA,OAAO,CAAChE,KAAD,CAAP;IACDA,MAAAA,KAAK,GAAGsE,IAAR;IACH;IAP0B,GAA/B;IASH;;IAEM,SAASN,OAAT,CAAiBP,IAAjB,EAAuB;IAC1B;IACA,MAAG,CAACF,QAAQ,CAACE,IAAD,CAAZ,EAAmB;IACf;IACH;;IACD,MAAGA,IAAI,CAACP,MAAR,EAAe;IACX;IACH,GAPyB;;;IAS1B,SAAO,IAAIM,QAAJ,CAAaC,IAAb,CAAP;IACH;;ICnDM,SAASc,SAAT,CAAmBC,EAAnB,EAAsB;IACzB,MAAMC,IAAI,GAAGD,EAAE,CAACE,QAAhB;;IACA,MAAGD,IAAI,CAAChB,IAAR,EAAa;IACT;IACAkB,IAAAA,QAAQ,CAACH,EAAD,CAAR;IAEH;IACJ;;IAED,SAASI,KAAT,CAAeJ,EAAf,EAAkBK,MAAlB,EAAyBX,GAAzB,EAA6B;IACzB1B,EAAAA,MAAM,CAACkB,cAAP,CAAsBc,EAAtB,EAAyBN,GAAzB,EAA6B;IACzBE,IAAAA,GADyB,iBACpB;IACD,aAAOI,EAAE,CAACK,MAAD,CAAF,CAAWX,GAAX,CAAP;IACH,KAHwB;IAIzBG,IAAAA,GAJyB,eAIrBC,IAJqB,EAIhB;IACLE,MAAAA,EAAE,CAACK,MAAD,CAAF,CAAWX,GAAX,IAAkBI,IAAlB;IACH;IANwB,GAA7B;IAQH;;IACD,SAASK,QAAT,CAAkBH,EAAlB,EAAqB;IACjB,MAAIf,IAAI,GAAGe,EAAE,CAACE,QAAH,CAAYjB,IAAvB,CADiB;;IAGjBA,EAAAA,IAAI,GAAGe,EAAE,CAACM,KAAH,GAAYzB,UAAU,CAACI,IAAD,CAAV,GAAiBA,IAAI,CAACe,EAAD,CAArB,GAA0Bf,IAA7C,CAHiB;;IAKjB,OAAI,IAAIS,GAAR,IAAeT,IAAf,EAAoB;IAChBmB,IAAAA,KAAK,CAACJ,EAAD,EAAI,OAAJ,EAAYN,GAAZ,CAAL;IACH,GAPgB;;;IASjBF,EAAAA,OAAO,CAACP,IAAD,CAAP;IACH;;IC9BM,SAASsB,SAAT,CAAmBC,GAAnB,EAAuB;IAC1B;IACAA,EAAAA,GAAG,CAAC1C,SAAJ,CAAc2C,KAAd,GAAsB,UAASC,OAAT,EAAiB;IACnC,QAAMV,EAAE,GAAG,IAAX,CADmC;;IAGnCA,IAAAA,EAAE,CAACE,QAAH,GAAcQ,OAAd,CAHmC;IAInC;;IACAX,IAAAA,SAAS,CAACC,EAAD,CAAT;IACH,GAND;;IAOAQ,EAAAA,GAAG,CAAC1C,SAAJ,CAAc6C,MAAd,GAAuB,UAAS/G,EAAT,EAAa;IAChC,QAAMoG,EAAE,GAAG,IAAX;IACA,QAAMU,OAAO,GAAGV,EAAE,CAACE,QAAnB,CAFgC;;IAIhCtG,IAAAA,EAAE,GAAGgH,QAAQ,CAACC,aAAT,CAAuBjH,EAAvB,CAAL,CAJgC;;IAMhCoG,IAAAA,EAAE,CAACc,GAAH,GAASlH,EAAT,CANgC;;IAQhC,QAAG,CAAC8G,OAAO,CAACK,MAAZ,EAAmB;IACf,UAAIpD,QAAQ,GAAG+C,OAAO,CAAC/C,QAAvB;;IACA,UAAG,CAACA,QAAD,IAAa/D,EAAhB,EAAmB;IACf;IACA+D,QAAAA,QAAQ,GAAG/D,EAAE,CAACoH,SAAd,CAFe;;IAIf,YAAID,MAAM,GAAGrD,iBAAiB,CAACC,QAAD,CAA9B,CAJe;;IAMf+C,QAAAA,OAAO,CAACK,MAAR,GAAiBA,MAAjB;IACH;IACJ;IACJ,GAnBD;IAoBH;;IC9BD,SAASP,GAAT,CAAaE,OAAb,EAAsB;IAClB;IACA,OAAKD,KAAL,CAAWC,OAAX;IACH;;IACDH,SAAS,CAACC,GAAD,CAAT;;;;;;;;"}