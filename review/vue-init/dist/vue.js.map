{"version":3,"file":"vue.js","sources":["../scr/util.js","../scr/observe/array.js","../scr/observe/index.js","../scr/state.js","../scr/init.js","../scr/index.js"],"sourcesContent":["export function isFunction (data){\r\n    return typeof data === 'function'\r\n}\r\n\r\nexport function isObject (data) {\r\n    return typeof data ==='object'&& data!=null;\r\n}","export  let arrayMethods =  Object.create(Array.prototype);\r\n    const methods = [\r\n        'push',\r\n        'shift',\r\n        'unshift',\r\n        'splice',\r\n        'pop',\r\n        'reverse',\r\n        'sort',\r\n    ]\r\n    methods.forEach(method=>{\r\n        arrayMethods[method] = function(...args){\r\n            console.log('数组改变了');\r\n            Array.prototype[method].call(this,...args);\r\n            let inserted;\r\n            switch (args) {\r\n                case 'push':\r\n                case 'unshift':\r\n                    inserted = args     \r\n                    break;\r\n                case 'splice':\r\n                    inserted = args.slice(2);\r\n               \r\n            }\r\n            if(inserted){\r\n                let op = this.__op__;\r\n                op.observeArray(inserted);\r\n            }\r\n           \r\n        }\r\n    })\r\n","import { isObject } from \"../util\";\r\nimport { arrayMethods } from \"./array\";\r\n\r\nexport function observe(data){\r\n    if(!isObject(data)){\r\n        return ;\r\n    }\r\n    if(data.__op__){\r\n        return ;\r\n    }\r\n    return new Observer(data);\r\n}\r\n\r\nclass Observer {\r\n    constructor(data){\r\n        Object.defineProperty(data,'__op__',{\r\n            value:this,\r\n            enumerable:false\r\n        })\r\n        if(Array.isArray(data)){\r\n            data.__proto__ = arrayMethods;\r\n            this.observeArray(data);\r\n        }\r\n        else {\r\n            this.walk(data);\r\n        }\r\n    }\r\n    observeArray(data){\r\n        data.forEach(item=>{\r\n            observe(item);\r\n        })\r\n    }\r\n    walk(data){\r\n        Object.keys(data).forEach(item =>{\r\n\r\n            defineReactive(data,item,data[item]);\r\n        })\r\n    }\r\n\r\n\r\n}\r\n\r\nfunction defineReactive (data,key,value){\r\n    observe(value)\r\n    Object.defineProperty(data,key,{\r\n        get(){\r\n            return value;\r\n        },\r\n        set(newV){\r\n            observe(newV)\r\n            value = newV;\r\n        }\r\n    })\r\n}","import { observe } from \"./observe/index\";\r\nimport { isFunction } from \"./util\";\r\n\r\nexport function initState(vm){\r\n    let options = vm.$options;\r\n    //初始化数据\r\n    if(options.data){\r\n        initData(vm);\r\n    }\r\n}\r\nfunction proxy(vm,source,key){\r\n    Object.defineProperty(vm,key,{\r\n        get(){\r\n            return vm[source][key];\r\n        },\r\n        set(newV){\r\n            vm[source][key] = newV;\r\n        }   \r\n\r\n    })\r\n}\r\n\r\nfunction initData(vm){\r\n    let data = vm.$options.data;\r\n    data = vm._data = isFunction(data)?data.call(this):data;\r\n    for(let key in data){\r\n        proxy(vm,'_data',key);\r\n    }\r\n    observe(data);\r\n}","import { initState } from \"./state\";\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function(options){\r\n        this.$options = options;\r\n        //获取实例\r\n        const vm = this;\r\n        //初始化状态\r\n        initState(vm);\r\n    }\r\n}","import { initMixin } from \"./init\"\r\n\r\nexport default function Vue(options){\r\n    this._init(options)\r\n}\r\n\r\ninitMixin(Vue);\r\n\r\n"],"names":["isFunction","data","isObject","arrayMethods","Object","create","Array","prototype","methods","forEach","method","console","log","args","call","inserted","slice","op","__op__","observeArray","observe","Observer","defineProperty","value","enumerable","isArray","__proto__","walk","item","keys","defineReactive","key","get","set","newV","initState","vm","options","$options","initData","proxy","source","_data","initMixin","Vue","_init"],"mappings":"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"}